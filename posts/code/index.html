<!doctype html><html lang=en><head><title>Blogging with code - Bjartek</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The HTML5 Herald"><meta name=author content="Bjarte Karlsen"><meta property="og:title" content="Blogging with code"><meta property="og:description" content="When writing a technical blog you often want to include code snippts inside your blog posts, however you do not want to have to do tedious copy and paste between your actual code and the blog posts."><meta property="og:type" content="article"><meta property="og:url" content="/posts/code/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-03-30T21:15:23+02:00"><meta property="article:modified_time" content="2021-03-30T21:15:23+02:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Blogging with code"><meta name=twitter:description content="When writing a technical blog you often want to include code snippts inside your blog posts, however you do not want to have to do tedious copy and paste between your actual code and the blog posts."><meta name=generator content="Hugo 0.82.0"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin=anonymous><link rel=stylesheet href=fontawesome/css/all.min.css><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto+Slab|Ruda"><link rel=stylesheet type=text/css href=/css/styles.css></head><body><div id=container><header><h1><a href=/>Bjartek</a></h1><ul id=social-media><li><a href=https://github.com/bjartek title=GitHub><i class="fab fa-github fa-lg"></i></a></li><li><a href=https://twitter.com/bjartek title=Twitter><i class="fab fa-twitter fa-lg"></i></a></li><li><a href=https://linkedin.com/in/bjartek title=LinkedIn><i class="fab fa-linkedin fa-lg"></i></a></li><li><a href=https://stackoverflow.com/bjartek title=StackOverflow><i class="fab fa-stack-overflow fa-lg"></i></a></li></ul><p><em>#dev #reader #tool-smith #firefly #vim #fish #cli #kubernetes #flow</em></p></header><nav><ul><li><a href=/categories/blogging><i class="fa-li fa fa-lg"></i><span>Blogging</span></a></li><li><a href=/about/><i class="fa-li fa fa-lg"></i><span>About</span></a></li></ul></nav><main><article><h1>Blogging with code</h1><aside><ul><li><time class=post-date datetime=2021-03-30T21:15:23+02:00>Mar 30, 2021</time></li><li>Categories:
<em><a href=/categories/blogging>blogging</a></em></li><li><em><a href=/tags/hugo>#hugo</a>
,
<a href=/tags/chroma>#chroma</a>
,
<a href=/tags/code>#code</a></em></li><li>2 minute read</li></ul></aside><p>When writing a technical blog you often want to include code snippts inside your blog posts, however you do not want to have to do tedious copy and paste between your actual code and the blog posts. Also you want to ensure that your code actually compiles. There is nothing more annoying then code samples that does not compile.</p><p>In order to cope with this I have crated a <code>shortcode</code> <a href=https://raw.githubusercontent.com/bjartek/bjartek.github.com/main/layouts/shortcodes/code.html#>code</a> for hugo that allows me to</p><ul><li>read a file with a given <code>file</code> from the filsystem</li><li>optional only read from <code>start</code> to <code>end</code></li><li>highlight is as the extension of the file, or optionaly as <code>language</code></li><li>show line numbers</li><li>optionaly highlight some <code>hl_lines</code> line numbers</li><li>works with chroma build in styling (not highlightjs)</li></ul><p>The shortcode`s code is as follows: (using the shortcode to show itself)</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style=display:block;width:100%;background-color:#3c3d38><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span></span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">24
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">25
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">26
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">27
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">28
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>{{ $fileName := .Get &#34;file&#34; }}

{{ $extension := path.Ext $fileName }}
{{ $extension := replace $extension &#34;.&#34; &#34;&#34; }}
{{ $lang := default $extension (.Get &#34;language&#34;) }}

{{ $file := $fileName | readFile }}
<span style=display:block;width:100%;background-color:#3c3d38>{{ $highlight := .Get &#34;hl_lines&#34; | printf &#34;hl_lines=[%s],&#34; }}
</span>

{{ $start := 1 }}
{{ if .Get &#34;start&#34; }}
  {{ $start := .Get &#34;start&#34; | int }}
  {{ $end := .Get &#34;end&#34; | int }}
  {{ $length := sub $end $start }}

  {{/* Splitting content by newline */}}
  {{ $file := split $file &#34;\n&#34; }}

  {{/* Limit the array/slice,  start from 2nd item then grab all first 3 item */}}
  {{ $file := first $length (after $start $file) }}

  {{/* Delimit by newline */}}
  {{ $file := delimit $file &#34;\n&#34; }}
{{ end }}

{{ (print &#34;```&#34; $lang &#34; {linenos=table,&#34; $highlight &#34;linenostart=&#34; $start &#34; }\n&#34; $file &#34;```&#34;) | safeHTML  }}

</code></pre></td></tr></table></div></div></article><section class=post-nav><ul><li><a href=/posts/blogging/><i class="fa fa-chevron-circle-left"></i> Blogging</a></li></ul></section></main><footer><h6>Copyright Â© 2021 - Bjarte Karlsen |
Rendered by <a href=https://gohugo.io title=Hugo>Hugo</a> |
<a href=index.xml>Subscribe</a></h6></footer></div><script src=/js/scripts.js></script></body></html>